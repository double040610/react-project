{"version":3,"file":"static/js/221.8fbc0735.chunk.js","mappings":"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","sources":["pages/Article/index.js","store/login.Store.js","store/user.Store.js","store/channel.Store.js","store/index.js"],"sourcesContent":["import img404 from '@/assets/error.png'\r\nimport './index.scss'\r\nimport { Link, useNavigate } from 'react-router-dom'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { Table, Tag, Space, Card, Breadcrumb, Form, Button, Radio, DatePicker, Select } from 'antd'\r\nimport 'moment/locale/zh-cn'\r\nimport locale from 'antd/es/date-picker/locale/zh_CN'\r\nimport { EditOutlined, DeleteOutlined } from '@ant-design/icons'\r\nimport { useEffect, useState } from 'react'\r\nimport { http } from '@/utils'\r\nimport { useStore } from '@/store'\r\n\r\nconst { Option } = Select\r\nconst { RangePicker } = DatePicker\r\n\r\nconst Article = () => {\r\n  const { channelStore } = useStore()\r\n\r\n  // 文章列表管理 统一管理数据 将来修改给setArticleData传对象\r\n  const [articleData, setArticleData] = useState({\r\n    list: [],// 文章列表\r\n    count: 0 // 文章数量\r\n  })\r\n\r\n  // 文章参数管理\r\n  const [params, setParams] = useState({\r\n    page: 1,\r\n    per_page: 10\r\n  })\r\n  // 获取文章列表\r\n  useEffect(() => {\r\n    const loadList = async () => {\r\n      const res = await http.get('/mp/articles', { params })\r\n      const { results, total_count } = res.data\r\n      setArticleData({\r\n        list: results,\r\n        count: total_count\r\n      })\r\n    }\r\n    loadList()\r\n  }, [params])\r\n\r\n  /* 表单筛选功能实现 */\r\n  const onFinish = (values) => {\r\n    const { channel_id, date, status } = values\r\n    // 数据处理\r\n    const _params = {}\r\n    // 格式化status\r\n    _params.status = status\r\n   \r\n    // 初始化频道\r\n    if (channel_id) {\r\n      _params.channel_id = channel_id\r\n    }\r\n    // 初始化时间\r\n    if (date) {\r\n      _params.begin_pubdate = date[0].format('YYYY-MM-DD')\r\n      _params.end_pubdate = date[1].format('YYYY-MM-DD')\r\n    }\r\n    // 修改params数据 引起接口的重新发送 对象的合并是一个整体覆盖 改了对象的整体引用\r\n    setParams({\r\n      ...params,\r\n      ..._params\r\n    })\r\n  }\r\n  // 翻页实现\r\n  const pageChange = (page) => {\r\n    setParams({\r\n      ...params,\r\n      page\r\n    })\r\n  }\r\n\r\n  const formatStatus = (type) => {\r\n    const TYPES = {\r\n      1: <Tag color=\"red\">审核失败</Tag>,\r\n      2: <Tag color=\"green\">审核成功</Tag>\r\n    }\r\n    return TYPES[type]\r\n  }\r\n\r\n  // 删除文章\r\n  const delArticle = async (data) => {\r\n    await http.delete(`/mp/articles/${data.id}`)\r\n    // 刷新一下列表\r\n    setParams({\r\n      ...params,\r\n      page: 1\r\n    })\r\n  }\r\n\r\n  // 编辑文章\r\n  const navigate = useNavigate()\r\n  const goPublish = (data) => {\r\n    navigate(`/react-project/publish?id=${data.id}`)\r\n  }\r\n\r\n  const columns = [\r\n    {\r\n      title: '封面',\r\n      dataIndex: 'cover',\r\n      width: 120,\r\n      render: cover => {\r\n        return <img src={cover.images[0] || img404} width={80} height={60} alt=\"\" />\r\n      }\r\n    },\r\n    {\r\n      title: '标题',\r\n      dataIndex: 'title',\r\n      width: 220\r\n    },\r\n    {\r\n      title: '状态',\r\n      dataIndex: 'status',\r\n      render: data => formatStatus(data)\r\n    },\r\n    {\r\n      title: '发布时间',\r\n      dataIndex: 'pubdate'\r\n    },\r\n    {\r\n      title: '阅读数',\r\n      dataIndex: 'read_count'\r\n    },\r\n    {\r\n      title: '评论数',\r\n      dataIndex: 'comment_count'\r\n    },\r\n    {\r\n      title: '点赞数',\r\n      dataIndex: 'like_count'\r\n    },\r\n    {\r\n      title: '操作',\r\n      render: data => {\r\n        return (\r\n          <Space size=\"middle\">\r\n            <Button\r\n              type=\"primary\"\r\n              shape=\"circle\"\r\n              icon={<EditOutlined />}\r\n              onClick={() => goPublish(data)} />\r\n            <Button\r\n              type=\"primary\"\r\n              danger\r\n              shape=\"circle\"\r\n              icon={<DeleteOutlined />}\r\n              onClick={() => delArticle(data)}\r\n            />\r\n          </Space>\r\n        )\r\n      },\r\n      fixed: 'right'\r\n    }\r\n  ]\r\n\r\n  return (\r\n    <div>\r\n      {/* 筛选区域 */}\r\n      <Card\r\n        title={\r\n          <Breadcrumb separator=\">\">\r\n            <Breadcrumb.Item>\r\n              <Link to=\"/react-project\">首页</Link>\r\n            </Breadcrumb.Item>\r\n            <Breadcrumb.Item>内容管理</Breadcrumb.Item>\r\n          </Breadcrumb>\r\n        }\r\n        style={{ marginBottom: 20 }}\r\n      >\r\n        <Form\r\n          onFinish={onFinish}\r\n          initialValues={{ status: null }}>\r\n          <Form.Item label=\"状态\" name=\"status\">\r\n            <Radio.Group>\r\n              <Radio value={null}>全部</Radio>\r\n              <Radio value={0}>草稿</Radio>\r\n              <Radio value={1}>待审核</Radio>\r\n              <Radio value={2}>审核通过</Radio>\r\n              <Radio value={3}>审核失败</Radio>\r\n            </Radio.Group>\r\n          </Form.Item>\r\n\r\n          <Form.Item label=\"频道\" name=\"channel_id\">\r\n            <Select\r\n              placeholder=\"请选择文章频道\"\r\n              style={{ width: 120 }}\r\n            >\r\n              {channelStore.channelList.map(channel => <Option key={channel.id} value={channel.id}>{channel.name}</Option>)}\r\n            </Select>\r\n          </Form.Item>\r\n\r\n          <Form.Item label=\"日期\" name=\"date\">\r\n            {/* 传入locale属性 控制中文显示*/}\r\n            <RangePicker locale={locale}></RangePicker>\r\n          </Form.Item>\r\n\r\n          <Form.Item>\r\n            <Button type=\"primary\" htmlType=\"submit\" style={{ marginLeft: 80 }}>\r\n              筛选\r\n            </Button>\r\n          </Form.Item>\r\n        </Form>\r\n      </Card>\r\n      {/* 文章列表区域 */}\r\n      <Card title={`根据筛选条件共查询到 ${articleData.count} 条结果：`}>\r\n        <Table\r\n          rowKey=\"id\"\r\n          columns={columns}\r\n          dataSource={articleData.list}\r\n          pagination={\r\n            {\r\n              pageSize: params.per_page,\r\n              total: articleData.count,\r\n              onChange: pageChange,\r\n              current: params.page\r\n            }\r\n          }\r\n          bordered\r\n        />\r\n      </Card>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default observer(Article)","// login module\r\nimport { makeAutoObservable } from 'mobx'\r\nimport { http, setToken, getToken, removeToken } from '@/utils'\r\nclass LoginStore {\r\n  token = getToken() || ''\r\n  constructor() {\r\n    // 响应式\r\n    makeAutoObservable(this)\r\n  }\r\n  getToken = async ({ mobile, code }) => {\r\n    // 调用登录接口\r\n    const res = await http.post('http://geek.itheima.net/v1_0/authorizations', {\r\n      mobile, code\r\n    })\r\n    // 存入token\r\n    this.token = res.data.token\r\n    // 存入ls\r\n    setToken(this.token)\r\n  }\r\n  // 退出登录\r\n  loginOut = () => {\r\n    this.token = ''\r\n    removeToken()\r\n  }\r\n}\r\n\r\nexport default LoginStore","import { makeAutoObservable } from 'mobx'\r\nimport { http } from '@/utils'\r\n\r\nclass UserStore {\r\n  userInfo = {}\r\n  constructor() {\r\n    makeAutoObservable(this)\r\n  }\r\n  getUserInfo = async () => {\r\n    // 调用接口获取数据\r\n    const res = await http.get('/user/profile')\r\n    this.userInfo = res.data\r\n  }\r\n}\r\n\r\nexport default UserStore","import { makeAutoObservable } from 'mobx'\r\nimport { http } from '@/utils'\r\nclass ChannelStore {\r\n  channelList = []\r\n  constructor() {\r\n    makeAutoObservable(this)\r\n  }\r\n  // article publish 哪里调用这个函数呢？\r\n  loadChannelList = async () => {\r\n    const res = await http.get('/channels')\r\n    this.channelList = res.data.channels\r\n  }\r\n}\r\n\r\nexport default ChannelStore","// 把所有的模块做统一处理\r\n// 导出一个统一的方法 useStore\r\nimport React from \"react\"\r\nimport LoginStore from \"./login.Store\"\r\nimport UserStore from \"./user.Store\"\r\nimport ChannelStore from \"./channel.Store\"\r\n\r\nimport { configure } from \"mobx\"\r\nconfigure({\r\n  enforceActions: \"never\",\r\n})\r\n\r\n\r\nclass RootStore {\r\n  constructor() {\r\n    this.loginStore = new LoginStore()\r\n    this.userStore = new UserStore()\r\n    this.channelStore = new ChannelStore()\r\n    // ...\r\n  }\r\n}\r\n\r\n// 实例化根\r\n// 导出useStore context\r\nconst rootStore = new RootStore()\r\nconst context = React.createContext(rootStore)\r\n\r\nconst useStore = () => React.useContext(context)\r\n\r\nexport { useStore }"],"names":["Option","Select","RangePicker","DatePicker","observer","channelStore","useStore","useState","list","count","articleData","setArticleData","page","per_page","params","setParams","useEffect","loadList","http","res","data","results","total_count","delArticle","id","navigate","useNavigate","columns","title","dataIndex","width","render","cover","src","images","height","alt","type","color","size","shape","icon","EditOutlined","onClick","goPublish","danger","DeleteOutlined","fixed","separator","to","style","marginBottom","onFinish","values","channel_id","date","status","_params","begin_pubdate","format","end_pubdate","initialValues","label","name","value","placeholder","channelList","map","channel","locale","htmlType","marginLeft","rowKey","dataSource","pagination","pageSize","total","onChange","current","bordered","LoginStore","token","getToken","mobile","code","setToken","loginOut","removeToken","makeAutoObservable","this","UserStore","userInfo","getUserInfo","ChannelStore","loadChannelList","channels","configure","enforceActions","rootStore","RootStore","loginStore","userStore","context","React"],"sourceRoot":""}